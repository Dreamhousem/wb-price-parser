# Dreamhouse WB Price Bot (BY) ‚Äî MultiMode (MM0.4.0)

Telegram‚Äë–±–æ—Ç –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ü–µ–Ω **Wildberries –ë–µ–ª–∞—Ä—É—Å—å** –ø–æ –∞—Ä—Ç–∏–∫—É–ª–∞–º (nmId).  
–ë–æ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ü–µ–Ω—ã —á–µ—Ä–µ–∑ WB API, **–ø–∏—à–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –≤ `data/prices.csv`** –∏ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∫–æ–≥–¥–∞ —Ü–µ–Ω–∞ –¥–æ—Å—Ç–∏–≥–ª–∞ —Ü–µ–ª–∏.

> –í–µ—Ç–∫–∞: `multimode`  
> –í–µ—Ä—Å–∏—è: **MM0.4.0**

---

## ‚ú® –ß—Ç–æ —É–º–µ–µ—Ç (–Ω–∞ —Ç–µ–∫—É—â–µ–º —ç—Ç–∞–ø–µ)

- **/add `<nmId>` `<—Ü–µ–Ω–∞>`** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä –∏ —Ü–µ–ª–µ–≤—É—é —Ü–µ–Ω—É (–±–æ—Ç —Å–∞–º –ø–æ–¥—Ç—è–Ω–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Å WB)
- **/list** ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å–æ–∫ + **—Ç–µ–∫—É—â–∏–µ —Ü–µ–Ω—ã** (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à, —á—Ç–æ–±—ã –ª–∏—à–Ω–∏–π —Ä–∞–∑ –Ω–µ –¥–µ—Ä–≥–∞—Ç—å WB)
- **/del `<nmId>`** ‚Äî —É–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –∏–∑ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- **/status** ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (—Ä–µ–≥–∏–æ–Ω/–≤–∞–ª—é—Ç–∞/–∏–Ω—Ç–µ—Ä–≤–∞–ª)
- **–ü–ª–∞–Ω–æ–≤—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏** –∫–∞–∂–¥—ã–µ `CHECK_INTERVAL_MINUTES` –º–∏–Ω—É—Ç
- **–ê–Ω—Ç–∏‚Äë—Å–ø–∞–º**: –µ—Å–ª–∏ —Ü–µ–Ω–∞ –¥–µ—Ä–∂–∏—Ç—Å—è –Ω–∏–∂–µ —Ü–µ–ª–∏ ‚Äî –Ω–µ —à–ª–µ—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω–æ
- **–ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω**: –∫–∞–∂–¥–∞—è –ø–ª–∞–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∏—à–µ—Ç —Å—Ç—Ä–æ–∫—É –≤ `data/prices.csv` (–¥–ª—è Excel/–∞–Ω–∞–ª–∏—Ç–∏–∫–∏)
- **–õ–æ–≥–∏**: `logs/bot.log` + –≤—ã–≤–æ–¥ –≤ –∫–æ–Ω—Å–æ–ª—å

‚ö†Ô∏è –°–µ–π—á–∞—Å –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∂–∏–º–µ **owner-only**: –æ—Ç–≤–µ—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤–ª–∞–¥–µ–ª—å—Ü—É (ID –±–µ—Ä–µ—Ç—Å—è –∏–∑ `.env`).  
–ü—É–±–ª–∏—á–Ω—ã–π —Ä–µ–∂–∏–º ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (–Ω–µ –≤ MM0.4.0).

---

## üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ (–∫–∞–∫ –µ—Å—Ç—å —Å–µ–π—á–∞—Å)

```text
wb_price_parser/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ config.py        # –∑–∞–≥—Ä—É–∑–∫–∞ config.json + .env
‚îÇ   ‚îú‚îÄ‚îÄ wb_api.py        # –∑–∞–ø—Ä–æ—Å—ã –∫ WB API (aiohttp)
‚îÇ   ‚îú‚îÄ‚îÄ parser.py        # –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ü–µ–Ω—ã –∏–∑ JSON
‚îÇ   ‚îú‚îÄ‚îÄ storage.py       # subscriptions/state + prices.csv
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py      # –∫–æ–º–∞–Ω–¥—ã Telegram (/add /list /del /status)
‚îÇ   ‚îú‚îÄ‚îÄ checker.py       # –ø–ª–∞–Ω–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–Ω + —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ notify.py        # (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è) –æ–±–µ—Ä—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ subscriptions.json   # —Å–ø–∏—Å–æ–∫ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤ (MVP-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ)
‚îÇ   ‚îú‚îÄ‚îÄ state.json           # –∫—ç—à —Ü–µ–Ω/–≤—Ä–µ–º–µ–Ω–∏ + —Ñ–ª–∞–≥ in_alert
‚îÇ   ‚îî‚îÄ‚îÄ prices.csv           # –∏—Å—Ç–æ—Ä–∏—è –∑–∞–º–µ—Ä–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚îú‚îÄ‚îÄ logs/
‚îÇ   ‚îî‚îÄ‚îÄ bot.log
‚îú‚îÄ‚îÄ .env.example
‚îú‚îÄ‚îÄ config.example.json
‚îú‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1) –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone <repo_url>
cd <repo_folder>
```

### 2) –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

```bash
python3 -m venv venv
source venv/bin/activate
```

### 3) –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

---

## üßæ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### 1) `.env` (—Å–µ–∫—Ä–µ—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—É—Å–∫–∞)

–°–æ–∑–¥–∞–π `.env` —Ä—è–¥–æ–º —Å `main.py`:

```ini
TG_BOT_TOKEN=–≤–∞—à_—Ç–æ–∫–µ–Ω_–∏–∑_BotFather
TG_CHAT_ID=–≤–∞—à_telegram_id

# –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø–ª–∞–Ω–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ (–º–∏–Ω)
CHECK_INTERVAL_MINUTES=10

# —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: DEBUG / INFO / WARNING / ERROR
LOG_LEVEL=INFO
```

–§–∞–π–ª `.env` **–Ω–µ –∫–æ–º–º–∏—Ç–∏–º**. –í —Ä–µ–ø–æ –¥–µ—Ä–∂–∏–º —Ç–æ–ª—å–∫–æ `.env.example`.

### 2) `config.json` (–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ WB)

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –µ—Å—Ç—å —à–∞–±–ª–æ–Ω: `config.example.json`.

```bash
cp config.example.json config.json
```

–ü–æ–ª—è `settings`:

- `currency` ‚Äî –≤–∞–ª—é—Ç–∞ (`byn`)
- `dest` ‚Äî —Ä–µ–≥–∏–æ–Ω –¥–æ—Å—Ç–∞–≤–∫–∏ (–≤–ª–∏—è–µ—Ç –Ω–∞ —Ü–µ–Ω—É/–ª–æ–≥–∏—Å—Ç–∏–∫—É)
- `spp` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä WB (—Å–∫–∏–¥–∫–∏/—É—Å–ª–æ–≤–∏—è)
- `timeout_seconds` ‚Äî —Ç–∞–π–º–∞—É—Ç –∑–∞–ø—Ä–æ—Å–∞
- `price_divider` ‚Äî –¥–µ–ª–∏—Ç–µ–ª—å –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ ‚Äú–∫–æ–ø–µ–µ–∫‚Äù –≤ BYN (–æ–±—ã—á–Ω–æ `100`)

> –í MM0.4.0 —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –∂–∏–≤–µ—Ç **–Ω–µ –≤ config.json**, –∞ –≤ `data/subscriptions.json`  
> (–ø–æ—Ç–æ–º—É —á—Ç–æ /add –∏ /del –º–µ–Ω—è—é—Ç –µ–≥–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏).

---

## ü§ñ –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### /start
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫—Ä–∞—Ç–∫—É—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é.

### /add `<nmId>` `<—Ü–µ–Ω–∞>`
–ü—Ä–∏–º–µ—Ä:

```
/add 322113946 10
```

–ë–æ—Ç:
1) –ø—Ä–æ–≤–µ—Ä–∏—Ç, —á—Ç–æ —Ç–æ–≤–∞—Ä —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (WB API)  
2) –≤—ã—Ç–∞—â–∏—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞  
3) –¥–æ–±–∞–≤–∏—Ç –≤ `data/subscriptions.json`  
4) –ø–æ–∫–∞–∂–µ—Ç —Ç–µ–∫—É—â—É—é —Ü–µ–Ω—É –∏ —Ü–µ–ª—å

### /list
–í—ã–≤–æ–¥–∏—Ç –ø–æ–¥–ø–∏—Å–∫–∏ —Å –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ —Ü–µ–Ω–∞–º–∏.

- –ï—Å–ª–∏ —Ü–µ–Ω–∞ ‚Äú—Å–≤–µ–∂–∞—è‚Äù (–∫—ç—à –∏–∑ `state.json` –º–æ–ª–æ–∂–µ `CHECK_INTERVAL_MINUTES`) ‚Äî –ø–æ–∫–∞–∂–µ—Ç –∫—ç—à.
- –ï—Å–ª–∏ ‚Äú–ø—Ä–æ—Ç—É—Ö–ª–∞‚Äù ‚Äî –æ–±–Ω–æ–≤–∏—Ç —Ü–µ–Ω—É —á–µ—Ä–µ–∑ WB API –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—à–µ—Ç –∫—ç—à.

### /del `<nmId>`
–£–¥–∞–ª—è–µ—Ç —Ç–æ–≤–∞—Ä –∏–∑ –ø–æ–¥–ø–∏—Å–æ–∫.

### /status
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª—é—á–µ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: –∏–Ω—Ç–µ—Ä–≤–∞–ª, dest, –≤–∞–ª—é—Ç–∞.

---

## üìà –ò—Å—Ç–æ—Ä–∏—è —Ü–µ–Ω: `data/prices.csv`

–§–∞–π–ª –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ (Excel‚Äëfriendly):

- —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: `;`
- –¥–µ—Å—è—Ç–∏—á–Ω—ã–π —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å: `,`

–ö–æ–ª–æ–Ω–∫–∏ (–ø—Ä–∏–º–µ—Ä–Ω–æ):

- `timestamp`
- `id`
- `name`
- `product_price`
- `logistics`
- `return`
- `total_price`
- `target_price`

> –ò—Å—Ç–æ—Ä–∏—è –ø–∏—à–µ—Ç—Å—è **–Ω–∞ –∫–∞–∂–¥–æ–π –ø–ª–∞–Ω–æ–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–µ** (–ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫), –¥–∞–∂–µ –µ—Å–ª–∏ —Ü–µ–Ω–∞ –Ω–µ —É–ø–∞–ª–∞.

---

## ü™µ –õ–æ–≥–∏

- `logs/bot.log` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –ª–æ–≥ —Ñ–∞–π–ª
- –∫–æ–Ω—Å–æ–ª—å ‚Äî –¥—É–±–ª–∏—Ä—É—é—â–∏–π –≤—ã–≤–æ–¥

–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–æ–≤:
- —Ñ–æ—Ä–º–∞—Ç: –≤—Ä–µ–º—è / –º–æ–¥—É–ª—å / —É—Ä–æ–≤–µ–Ω—å / —Å–æ–æ–±—â–µ–Ω–∏–µ
- —É—Ä–æ–≤–µ–Ω—å: —á–µ—Ä–µ–∑ `LOG_LEVEL` –≤ `.env`

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ Git

**–ù–µ –∫–æ–º–º–∏—Ç–∏—Ç—å:**
- `.env`
- `config.json` (–µ—Å–ª–∏ —Ç–∞–º –µ—Å—Ç—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)
- `data/*` (–ø–æ–¥–ø–∏—Å–∫–∏/–∫—ç—à/—Ü–µ–Ω—ã)
- `logs/*`

–í —Ä–µ–ø–æ –¥–æ–ª–∂–Ω—ã –∂–∏—Ç—å —Ç–æ–ª—å–∫–æ:
- `.env.example`
- `config.example.json`
- –∫–æ–¥ –∏ README

---

## üß∑ –ß–µ–Ω–¥–∂–ª–æ–≥

### MM0.4.0
- –¥–æ–±–∞–≤–ª–µ–Ω Telegram –±–æ—Ç (aiogram) + –∫–æ–º–∞–Ω–¥—ã `/add /list /del /status`
- –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ (APScheduler)
- –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (aiohttp)
- –∫—ç—à —Ü–µ–Ω/—Å—Ç–µ–π—Ç–∞ (state.json) –¥–ª—è ‚Äú—É–º–Ω–æ–≥–æ‚Äù /list
- –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞: –∑–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏ —Ü–µ–Ω –≤ `data/prices.csv`
- –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `logs/bot.log`

---

## üó∫Ô∏è Roadmap (–ø–æ–∑–∂–µ)

- Public‚Äë—Ä–µ–∂–∏–º: —Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º (multiuser)
- SQL‚Äë—Ö—Ä–∞–Ω–∏–ª–∏—â–µ (SQLite ‚Üí PostgreSQL), –æ—Ç–∫–∞–∑ –æ—Ç JSON‚Äë—Ñ–∞–π–ª–æ–≤
- —É–º–Ω—ã–π –∞–Ω—Ç–∏‚Äë—Å–ø–∞–º (cooldown/—É–ª—É—á—à–µ–Ω–∏–µ —Ü–µ–Ω—ã/—Å–≤–æ–¥–∫–∏)
- –æ—Ç—á–µ—Ç—ã: –º–∏–Ω–∏–º—É–º/—Å—Ä–µ–¥–Ω–µ–µ –∑–∞ 24—á/7–¥
- –∫–æ–º–∞–Ω–¥–∞ `/interval` –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–æ–∫ (MVP+)
